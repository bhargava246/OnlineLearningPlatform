# EduPlatform - Learning Management System

## Overview

EduPlatform is a full-stack learning management system built with modern web technologies. It provides a comprehensive platform for online education with features for students, instructors, and administrators. The application follows a traditional client-server architecture with a React frontend and Express.js backend, utilizing PostgreSQL for data persistence.

## System Architecture

### Frontend Architecture
- **Framework**: React 18 with TypeScript
- **Build Tool**: Vite for fast development and optimized builds
- **Routing**: Wouter for lightweight client-side routing
- **State Management**: TanStack Query (React Query) for server state management
- **UI Framework**: Tailwind CSS with shadcn/ui component library
- **Styling**: CSS variables for theming with dark/light mode support

### Backend Architecture
- **Runtime**: Node.js with Express.js framework
- **Language**: TypeScript with ES modules
- **Database**: PostgreSQL with Drizzle ORM
- **Database Provider**: Neon Database (serverless PostgreSQL)
- **API Design**: RESTful APIs with JSON responses
- **Development**: tsx for TypeScript execution in development

### Project Structure
- `/client/` - React frontend application
- `/server/` - Express.js backend application
- `/shared/` - Shared TypeScript types and database schema
- `/migrations/` - Database migration files (generated by Drizzle)

## Key Components

### Database Schema
The application uses a comprehensive database schema with the following main entities:
- **Users**: Student, instructor, and admin accounts with role-based access
- **Courses**: Course catalog with metadata, thumbnails, and instructor assignments
- **Course Modules**: Individual video lessons with ordering and completion tracking
- **Course Notes**: Downloadable PDF resources associated with courses
- **Enrollments**: Student-course relationships with progress tracking
- **Tests**: Assessment system for courses
- **Test Results**: Student performance tracking
- **Recent Activities**: User activity logging for dashboard insights

### Authentication & Authorization
- **Primary**: Email/password authentication with JWT tokens stored in localStorage
- **Secondary**: Replit OpenID Connect authentication as fallback option
- Role-based access control (student, instructor, admin)
- **User Approval Workflow**: New students require admin approval before accessing courses
- Session-based authentication for Replit auth, JWT for email/password auth

### User Interface Components
- **Dashboard**: Personalized learning overview with statistics
- **Course Catalog**: Browsable course listings with search and filtering
- **Course Player**: Video playback with progress tracking and note downloads
- **Test Results**: Performance analytics and grade tracking
- **Admin Panel**: System administration and analytics

## Data Flow

### Client-Server Communication
1. Frontend makes HTTP requests to `/api` endpoints
2. Backend processes requests with Express middleware
3. Database operations handled through Drizzle ORM
4. Responses sent as JSON with appropriate HTTP status codes

### State Management Flow
1. Components use TanStack Query for data fetching
2. Query keys correspond to API endpoints
3. Automatic caching and background refetching
4. Loading and error states handled declaratively

### File Upload/Download
- Course thumbnails and video URLs stored as text references
- PDF notes served through download URLs
- Static assets served from `/public` directory

## External Dependencies

### Frontend Dependencies
- **UI Components**: Radix UI primitives for accessibility
- **Form Handling**: React Hook Form with Zod validation
- **Date Utilities**: date-fns for date formatting
- **Icons**: Lucide React icon library
- **Carousel**: Embla Carousel for image galleries

### Backend Dependencies
- **Database**: @neondatabase/serverless for PostgreSQL connection
- **ORM**: Drizzle ORM with PostgreSQL dialect
- **Session Management**: connect-pg-simple for PostgreSQL session store
- **Validation**: Zod for runtime type checking

### Development Tools
- **Build**: esbuild for server bundling
- **Development**: tsx for TypeScript execution
- **Database Tools**: Drizzle Kit for migrations and schema management

## Deployment Strategy

### Development Environment
- Replit-based development with auto-reload
- Vite dev server with HMR for frontend
- tsx with file watching for backend development
- PostgreSQL database provided by Replit

### Production Build
- Frontend: Vite production build to `/dist/public`
- Backend: esbuild bundle to `/dist/index.js`
- Static file serving integrated with Express
- Environment-based configuration

### Replit Configuration
- Node.js 20 runtime environment
- PostgreSQL 16 database service
- Auto-scaling deployment target
- Port 5000 exposed externally on port 80

### Database Management
- Drizzle migrations for schema changes
- Environment variable for database connection
- Automatic schema push for development

## User Preferences

Preferred communication style: Simple, everyday language.

## Recent Changes

- **January 23, 2025**: Successfully migrated project from Replit Agent to Replit environment
  - **Migration Complete**: Project now runs cleanly in Replit environment with MongoDB
  - **Dependencies**: All Node.js packages properly installed and working
  - **Database**: MongoDB connection established and working (mongodb+srv://Himanshu:Himanshu123@himanshu.pe7xrly.mongodb.net/LMS)
  - **Server**: Express.js server running on port 5000 with proper logging
  - **Security**: Maintained existing authentication system with JWT and bcrypt
  - **Environment**: Optimized for Replit's Node.js 20 runtime
  - **Authentication Issues Fixed**: Removed authentication middleware blocking login routes
  - **Admin Features Fixed**: All admin routes now properly authenticated and working
    - User management (/api/mongo/admin/users) - shows all users with enrollment data
    - User approval system (/api/mongo/admin/pending-approvals) - displays students awaiting approval
    - Student test results (/api/mongo/admin/student-results) - shows student-wise test data
  - **Student Features Fixed**: Student test results now accessible via /api/mongo/student/my-results
  - **JWT Authentication**: Fixed middleware to properly extract user role and permissions


- **June 23, 2025**: Email/Password Authentication & User Approval Workflow Complete
  - **NEW: Dual Authentication System**
    - Primary: Email/password authentication with JWT tokens (default registration creates student accounts)
    - Secondary: Replit OpenID Connect authentication as fallback option
    - Admin accounts must be added directly via MongoDB, students register through UI
  - **NEW: User Approval Workflow**
    - New student registrations require admin approval before course access
    - Admin interface for reviewing and approving/rejecting pending users
    - Course-specific access control where admins assign approved courses to students
    - Real-time approval status banners for students showing pending/approved state
    - Automatic redirect to authentication page for unauthenticated users
  - **Authentication Features**
    - Beautiful two-column authentication page with login/register tabs
    - JWT token storage in localStorage with automatic logout on token expiry
    - Comprehensive error handling and user feedback during auth process
    - Header logout functionality supporting both authentication methods

- **June 23, 2025**: MongoDB Integration & Test Management System Complete
  - Successfully connected to user's MongoDB database (mongodb+srv://Himanshu:Himanshu123@himanshu.pe7xrly.mongodb.net/LMS)
  - Implemented course creation with YouTube videos and PDF notes
  - Course data uploads successfully to MongoDB with embedded modules and notes structure
  - Course detail pages load embedded YouTube videos and downloadable PDF links
  - **Complete Test Management System**
    - Admin can create tests for courses with validation
    - Comprehensive student grading interface where admins assign scores and grades
    - Students can view their test results and grades assigned by admin
    - Real-time grade management with MongoDB integration
    - Test statistics integrated into admin dashboard
    - Grade color-coding system (A+ to F) with proper visual feedback

## Changelog

- June 23, 2025: Initial setup and MongoDB integration completed
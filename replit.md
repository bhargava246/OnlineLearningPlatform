# EduPlatform - Learning Management System

## Overview

EduPlatform is a full-stack learning management system built with modern web technologies. It provides a comprehensive platform for online education with features for students, instructors, and administrators. The application follows a traditional client-server architecture with a React frontend and Express.js backend, utilizing PostgreSQL for data persistence.

## System Architecture

### Frontend Architecture
- **Framework**: React 18 with TypeScript
- **Build Tool**: Vite for fast development and optimized builds
- **Routing**: Wouter for lightweight client-side routing
- **State Management**: TanStack Query (React Query) for server state management
- **UI Framework**: Tailwind CSS with shadcn/ui component library
- **Styling**: CSS variables for theming with dark/light mode support

### Backend Architecture
- **Runtime**: Node.js with Express.js framework
- **Language**: TypeScript with ES modules
- **Database**: PostgreSQL with Drizzle ORM
- **Database Provider**: Neon Database (serverless PostgreSQL)
- **API Design**: RESTful APIs with JSON responses
- **Development**: tsx for TypeScript execution in development

### Project Structure
- `/client/` - React frontend application
- `/server/` - Express.js backend application
- `/shared/` - Shared TypeScript types and database schema
- `/migrations/` - Database migration files (generated by Drizzle)

## Key Components

### Database Schema
The application uses a comprehensive database schema with the following main entities:
- **Users**: Student, instructor, and admin accounts with role-based access
- **Courses**: Course catalog with metadata, thumbnails, and instructor assignments
- **Course Modules**: Individual video lessons with ordering and completion tracking
- **Course Notes**: Downloadable PDF resources associated with courses
- **Enrollments**: Student-course relationships with progress tracking
- **Tests**: Assessment system for courses
- **Test Results**: Student performance tracking
- **Recent Activities**: User activity logging for dashboard insights

### Authentication & Authorization
- **Primary**: Email/password authentication with JWT tokens stored in localStorage
- **Secondary**: Replit OpenID Connect authentication as fallback option
- Role-based access control (student, instructor, admin)
- **User Approval Workflow**: New students require admin approval before accessing courses
- Session-based authentication for Replit auth, JWT for email/password auth

### User Interface Components
- **Dashboard**: Personalized learning overview with statistics
- **Course Catalog**: Browsable course listings with search and filtering
- **Course Player**: Video playback with progress tracking and note downloads
- **Test Results**: Performance analytics and grade tracking
- **Admin Panel**: System administration and analytics

## Data Flow

### Client-Server Communication
1. Frontend makes HTTP requests to `/api` endpoints
2. Backend processes requests with Express middleware
3. Database operations handled through Drizzle ORM
4. Responses sent as JSON with appropriate HTTP status codes

### State Management Flow
1. Components use TanStack Query for data fetching
2. Query keys correspond to API endpoints
3. Automatic caching and background refetching
4. Loading and error states handled declaratively

### File Upload/Download
- Course thumbnails and video URLs stored as text references
- PDF notes served through download URLs
- Static assets served from `/public` directory

## External Dependencies

### Frontend Dependencies
- **UI Components**: Radix UI primitives for accessibility
- **Form Handling**: React Hook Form with Zod validation
- **Date Utilities**: date-fns for date formatting
- **Icons**: Lucide React icon library
- **Carousel**: Embla Carousel for image galleries

### Backend Dependencies
- **Database**: @neondatabase/serverless for PostgreSQL connection
- **ORM**: Drizzle ORM with PostgreSQL dialect
- **Session Management**: connect-pg-simple for PostgreSQL session store
- **Validation**: Zod for runtime type checking

### Development Tools
- **Build**: esbuild for server bundling
- **Development**: tsx for TypeScript execution
- **Database Tools**: Drizzle Kit for migrations and schema management

## Deployment Strategy

### Development Environment
- Replit-based development with auto-reload
- Vite dev server with HMR for frontend
- tsx with file watching for backend development
- PostgreSQL database provided by Replit

### Production Build
- Frontend: Vite production build to `/dist/public`
- Backend: esbuild bundle to `/dist/index.js`
- Static file serving integrated with Express
- Environment-based configuration

### Replit Configuration
- Node.js 20 runtime environment
- PostgreSQL 16 database service
- Auto-scaling deployment target
- Port 5000 exposed externally on port 80

### Database Management
- Drizzle migrations for schema changes
- Environment variable for database connection
- Automatic schema push for development

## User Preferences

Preferred communication style: Simple, everyday language.

## Recent Changes

- **July 07, 2025**: Admin Dashboard Analytics Update - Real-Time Comprehensive Stats Implemented
  - **Admin Analytics Enhanced**: Updated admin dashboard with comprehensive real-time analytics:
    - Replaced basic stats with four key metrics: Total Courses, Students Enrolled, Average Score, Average Completion
    - Real-time data refresh every 30 seconds with manual refresh button
    - Enhanced server endpoint `/api/mongo/admin/stats` with detailed enrollment and completion metrics
    - Modern gradient design with hover animations and color-coded cards (blue, green, purple, orange)
    - Live data indicators and improved visual hierarchy
  - **MongoDB Integration**: Enhanced stats calculation with real enrollment and test data
  - **All Systems Operational**: Admin panel showing live data from MongoDB database

- **July 07, 2025**: Migration Complete - Google OAuth Authentication Added & OTP Email Verification System
  - **Migration Successfully Completed**: All checklist items finished, project running smoothly in Replit environment
  - **Google OAuth Integration**: Complete Google authentication system implemented:
    - Added Google OAuth strategy with passport-google-oauth20
    - Updated User model to support Google authentication with email verification
    - Created Google OAuth routes (/api/auth/google and /api/auth/google/callback)
    - Integrated Google login and register buttons in authentication page with proper styling
    - Set up Google OAuth credentials in environment variables
    - Fixed passport serialization/deserialization for mixed authentication types
  - **OTP Email Verification System**: Complete email verification system implemented:
    - Added OTP fields to User model (emailVerificationOTP, otpExpiresAt)
    - Created dedicated email verification page with modern UI
    - Implemented nodemailer service for sending OTP emails
    - Added registration with OTP verification flow
    - Created resend OTP functionality with cooldown timer
    - Enhanced authentication routes to handle email verification
    - Added welcome email system after successful verification
  - **Authentication Features**: Dual authentication system now supports:
    - Regular email/password authentication with JWT tokens and OTP verification
    - Google OAuth authentication with automatic email verification
    - New Google users created as students requiring admin approval
    - Existing users can link Google accounts to their profiles
    - Proper session management for both authentication types
    - Email verification requirement for traditional registration
  - **All Systems Operational**: Authentication, course management, admin features working properly

- **January 13, 2025**: Migration Complete - Course Detail Page Redesigned with Modern Styling
  - **Migration Successfully Completed**: All checklist items finished, project running smoothly in Replit environment
  - **Course Detail Page Redesign**: Complete visual overhaul with stunning modern styling:
    - Added gradient background with backdrop blur effects for the main container
    - Enhanced header with vibrant blue-to-purple-to-pink gradient background
    - Redesigned video lecture cards with hover animations and gradient borders
    - Added colorful icon sections with gradient backgrounds for better visual hierarchy  
    - Enhanced course sidebar with sticky positioning and gradient styling
    - Implemented modern badges and pills for course metadata
    - Added smooth hover effects with scaling and shadow animations
    - Enhanced empty states with engaging gradient icons and messaging
  - **Visual Improvements**: Modern design system with gradients, shadows, and smooth transitions
  - **Dark Mode Support**: Complete dark mode compatibility across all new components
  - **All Systems Operational**: Authentication, course management, admin features working properly

- **July 05, 2025**: Migration Complete - Dashboard Refresh Button Fixed and Sidebar Logo Enhanced
  - **Migration Successfully Completed**: All checklist items finished, project running smoothly in Replit environment
  - **Dashboard Refresh Button Fixed**: 
    - Resolved 403 error issue with student results query for admin users
    - Updated refresh button to only query student results when user has student role
    - Fixed automatic refresh interval to respect user role permissions
    - Enhanced authentication flow to properly handle role-based access
  - **Sidebar Logo Redesigned**: Complete visual overhaul of the sidebar branding:
    - Added gradient background with hover animations and scaling effects
    - Enhanced typography with gradient text effect from white to blue
    - Added professional tagline: "LEARN • GROW • ACHIEVE"
    - Included pulsing accent dot with yellow-orange gradient
    - Improved spacing and interactive hover transitions
  - **All Systems Operational**: Authentication, course management, admin features working properly

- **July 05, 2025**: Modern UI Redesign Complete - Tests Section and Test Form Enhanced
  - **Migration Successfully Completed**: All checklist items finished, project running smoothly in Replit environment
  - **Tests Section Redesign**: Complete visual overhaul of admin panel tests section:
    - Transformed from simple list to modern grid layout with responsive columns
    - Added gradient backgrounds and hover effects with card scaling animations
    - Implemented colorful top borders with blue-to-purple-to-pink gradients
    - Enhanced visual elements with test icons, color-coded statistics, and modern badges
    - Added animated status indicators with pulsing green dots
    - Improved empty state with engaging gradient icon and feature highlights
  - **Test Form Enhancement**: Complete redesign of test creation form:
    - Added stunning gradient header with backdrop blur effects
    - Implemented two-card layout with distinct sections for information and settings
    - Enhanced form fields with larger inputs, emoji icons, and improved spacing
    - Added animated loading states and enhanced button styling
    - Improved course selection with rich visual dropdown items
    - Enhanced input fields with contextual units and improved focus states
  - **Visual Improvements**: Modern design system with gradients, shadows, and smooth transitions
  - **Dark Mode Support**: Complete dark mode compatibility across all new components
  - **All Systems Operational**: Authentication, course management, admin features working properly

- **July 05, 2025**: Migration from Replit Agent to Replit Environment Complete
  - **Migration Successfully Completed**: All checklist items completed, project running smoothly
  - **Application Running**: Express server operational on port 5000 with MongoDB connection
  - **Frontend Working**: Vite development server with hot-reload functionality active
  - **Course Card Enhancement**: Redesigned course card components with modern styling:
    - Added gradient backgrounds and improved visual hierarchy
    - Enhanced course statistics with color-coded icons and better spacing
    - Improved progress tracking with animated progress bars
    - Added modern button styling with hover effects and animations
  - **Landing Page Improvements**: Added alternating subsection backgrounds with themed gradients
    - Hero section with purple/violet gradient background
    - Features section with cyan/blue gradient background  
    - CTA section with green/emerald gradient background
  - **All Systems Operational**: Authentication, course management, admin features working properly

- **July 05, 2025**: Comprehensive UI/UX Redesign and Migration Complete
  - **Migration from Replit Agent to Replit**: Successfully completed migration with all systems working
  - **Navbar to Sidebar Conversion**: Replaced traditional navbar with consistent sidebar navigation across all pages
  - **Landing Page Improvements**: 
    - Removed all navbar options from starting page (keeping only logo and auth buttons)
    - Enhanced subsection background colors with themed gradients for better visual appeal
    - Removed "Watch Demo" and "View Course Catalog" buttons as requested
  - **Authentication Enhancements**:
    - Added clickable logo on login/signup page that redirects to landing page
    - Replaced "Login with Replit" with "Login with Google" option (placeholder implementation)
    - Improved login pop-up notification appearance
    - Updated login redirect to go to dashboard instead of previous page
    - Changed logout redirect to go to landing page instead of login page
    - Updated "Create Account" button with green gradient styling
  - **Dashboard Modernization**:
    - Converted navbar to shared sidebar component for consistency
    - Made logo in admin panel/dashboard clickable to redirect to dashboard
    - Added logout option to dashboard sidebar with red styling
    - Removed "Upgrade" option from UI
    - Removed "Creative Outdoor" advertisements, replaced with personalized welcome message
    - Implemented shared sidebar component for use across all authenticated pages
  - **Architecture Improvements**:
    - Created reusable Sidebar component in `/client/src/components/sidebar.tsx`
    - Updated dashboard to use shared sidebar for consistency
    - Enhanced component modularity and maintainability

- **July 03, 2025**: Migration from Replit Agent to Replit Environment Complete
  - **Migration Successfully Completed**: Project now runs cleanly in Replit environment
  - **CORS Configuration Fixed**: Added support for `https://www.online.toolshelp.me` and `https://online.toolshelp.me` domains
  - **Authentication System Enhanced**: Improved JWT token handling with better error responses
  - **Database Connection Stable**: MongoDB connection working properly with all features
  - **All Dependencies Working**: Node.js packages properly installed and configured
  - **Server Running**: Express.js server operational on port 5000 with proper logging
  - **Frontend Active**: Vite development server with hot-reload functionality
  - **Security Maintained**: Existing authentication system with JWT and bcrypt preserved

- **July 03, 2025**: Modern Frontend Redesign Complete
  - **Landing Page Redesign**: Completely redesigned with modern gradient backgrounds, inspired by Pro-Skills template
  - **Dashboard Redesign**: Implemented modern layout with dark blue sidebar, matching professional admin templates
  - **New Features Added**:
    - Gradient hero sections with animated decorative elements
    - Professional sidebar navigation with team sections and upgrade prompts
    - Modern card layouts with charts, progress indicators, and activity feeds
    - Contemporary color schemes with blue/purple gradients
    - Enhanced typography and spacing for better readability
    - Responsive design maintaining mobile compatibility
  - **Authentication Pages**: Updated with modern gradient backgrounds and improved UX
  - **Component Library**: Added Badge component and enhanced existing UI components
  - **Migration Complete**: Successfully migrated from Replit Agent to Replit environment
    - All Node.js packages installed and working
    - MongoDB connection established
    - Express server running properly on port 5000
    - Frontend hot-reload working with Vite
    - TypeScript compilation working without errors

- **June 24, 2025**: Production Deployment Configuration Complete - URLs Updated
  - **Vercel Frontend Setup**: Created vercel.json with proper routing and build configuration
  - **Render Backend Setup**: Added render.yaml, Dockerfile, and production scripts
  - **CORS Configuration**: Updated server to handle cross-origin requests from Vercel domain
  - **Environment Variables**: Configured production environment files and variables
  - **API Configuration**: Updated queryClient.ts to handle different API endpoints for production
  - **Build Scripts**: Added separate build commands for frontend and backend deployment
  - **Deployment Automation**: Created prepare-deployment.js script for easy configuration
  - **Documentation**: Complete deployment guide with step-by-step instructions
  - **URLs Configured**: Updated all config files with actual Render URL (https://onlinelearningplatform-ppes.onrender.com)
  - **Authentication Fixed**: Resolved JWT_SECRET environment variable issue causing token validation failures on Render

- **January 23, 2025**: Successfully migrated project from Replit Agent to Replit environment
  - **Migration Complete**: Project now runs cleanly in Replit environment with MongoDB
  - **Dependencies**: All Node.js packages properly installed and working
  - **Database**: MongoDB connection established and working (mongodb+srv://Himanshu:Himanshu123@himanshu.pe7xrly.mongodb.net/LMS)
  - **Server**: Express.js server running on port 5000 with proper logging
  - **Security**: Maintained existing authentication system with JWT and bcrypt
  - **Environment**: Optimized for Replit's Node.js 20 runtime
  - **Authentication Issues Fixed**: Removed authentication middleware blocking login routes
  - **Admin Features Fixed**: All admin routes now properly authenticated and working
    - User management (/api/mongo/admin/users) - shows all users with enrollment data
    - User approval system (/api/mongo/admin/pending-approvals) - displays students awaiting approval
    - Student test results (/api/mongo/admin/student-results) - shows student-wise test data
  - **Student Features Fixed**: Student test results now accessible via /api/mongo/student/my-results
  - **JWT Authentication**: Fixed middleware to properly extract user role and permissions


- **June 23, 2025**: Email/Password Authentication & User Approval Workflow Complete
  - **NEW: Dual Authentication System**
    - Primary: Email/password authentication with JWT tokens (default registration creates student accounts)
    - Secondary: Replit OpenID Connect authentication as fallback option
    - Admin accounts must be added directly via MongoDB, students register through UI
  - **NEW: User Approval Workflow**
    - New student registrations require admin approval before course access
    - Admin interface for reviewing and approving/rejecting pending users
    - Course-specific access control where admins assign approved courses to students
    - Real-time approval status banners for students showing pending/approved state
    - Automatic redirect to authentication page for unauthenticated users
  - **Authentication Features**
    - Beautiful two-column authentication page with login/register tabs
    - JWT token storage in localStorage with automatic logout on token expiry
    - Comprehensive error handling and user feedback during auth process
    - Header logout functionality supporting both authentication methods

- **June 23, 2025**: MongoDB Integration & Test Management System Complete
  - Successfully connected to user's MongoDB database (mongodb+srv://Himanshu:Himanshu123@himanshu.pe7xrly.mongodb.net/LMS)
  - Implemented course creation with YouTube videos and PDF notes
  - Course data uploads successfully to MongoDB with embedded modules and notes structure
  - Course detail pages load embedded YouTube videos and downloadable PDF links
  - **Complete Test Management System**
    - Admin can create tests for courses with validation
    - Comprehensive student grading interface where admins assign scores and grades
    - Students can view their test results and grades assigned by admin
    - Real-time grade management with MongoDB integration
    - Test statistics integrated into admin dashboard
    - Grade color-coding system (A+ to F) with proper visual feedback

## Changelog

- June 23, 2025: Initial setup and MongoDB integration completed